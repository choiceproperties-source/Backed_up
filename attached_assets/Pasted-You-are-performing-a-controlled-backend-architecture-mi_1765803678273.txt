You are performing a controlled backend architecture migration.

STRICT RULES (DO NOT VIOLATE):
- You must follow MIGRATION.md exactly.
- You must migrate ONLY the Leases domain.
- Do NOT touch Properties, Applications, Payments, or Auth domains.
- Do NOT delete or modify legacy routes in server/routes.ts.
- Do NOT rename any API endpoints.
- Do NOT change request or response shapes.
- Do NOT modify database schemas or tables.
- Do NOT refactor frontend code.
- Behavior must remain 100% identical.

TASK:
Migrate the Leases domain from the legacy server/routes.ts into a domain-based module located at:

server/modules/leases/

You must create the following files:
- lease.routes.ts
- lease.service.ts
- lease.repository.ts
- index.ts

RESPONSIBILITIES:
1. lease.routes.ts
- Register ONLY lease-related routes.
- Perform request parsing, auth middleware usage, and response formatting.
- NO business logic.
- NO database queries.

2. lease.service.ts
- Contain ALL business logic related to leases.
- Handle validation, authorization, state transitions, and rules.
- Call repository functions for data access.
- Logic must be equivalent to legacy behavior.

3. lease.repository.ts
- Contain ALL database queries related to leases.
- Queries must match legacy behavior exactly.
- Do NOT optimize or change logic.
- Preserve current query patterns, even if inefficient.

MIGRATION STEPS:
1. Locate ALL lease-related routes in server/routes.ts.
2. Copy their logic without modification.
3. Extract database access into lease.repository.ts.
4. Extract business logic into lease.service.ts.
5. Wire routes to services.
6. Register the new routes in index.ts WITHOUT removing legacy routes.
7. Ensure both legacy and new routes can coexist during migration.

ROUTES TO MIGRATE (actual routes in codebase):
- GET  /api/leases/:leaseId/payment-history
- POST /api/leases/:leaseId/generate-rent-payments
- GET  /api/leases/:leaseId/rent-payments
- POST /api/leases/:leaseId/approve
- PATCH /api/leases/:leaseId/update
- DELETE /api/leases/:leaseId
- GET  /api/leases/:leaseId/details
- GET  /api/leases/user/:userId
- GET  /api/leases/property/:propertyId

VERIFICATION REQUIREMENTS:
- Responses must match legacy routes exactly.
- Permissions must behave identically.
- Error messages must match legacy behavior.
- Logging behavior must remain unchanged.
- No new dependencies added.

DELIVERABLES:
- Create the four files listed above.
- Show code for each file.
- Show how the new routes are registered in the server.
- Do NOT delete any legacy code.
- Do NOT touch other domains.

STOP CONDITIONS:
If anything is ambiguous or unclear, STOP and ask before proceeding.